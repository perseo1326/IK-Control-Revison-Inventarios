<!DOCTYPE html><html lang=es><head><meta charset=UTF-8 /><meta http-equiv=X-UA-Compatible content="IE=edge" /><meta name=viewport content="width=device-width, initial-scale=1.0" /><meta name=autor content=https://github.com/perseo1326 /><link rel=preconnect href=https://fonts.googleapis.com /><link rel=preconnect href=https://fonts.gstatic.com crossorigin /><link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel=stylesheet /><meta name=autor content=https://github.com/perseo1326 /><link rel=stylesheet href=styles.css /><style>*{--background:white;--first-color:#0057a4;--second-color:#ffdb01;--warning-color:rgba(255,165,0,1);--edicion-color:#ff5100;padding:0;margin:0;font-family:'Roboto',sans-serif;box-sizing:border-box}body{background-color:var(--background)}div.container{padding:0 .5rem;display:flex;flex-direction:column}.no-visible{display:none}.margen-alta-05{margin-top:.5rem}.ancho-100{width:100%}.margen-bajo{margin-bottom:.5rem}.centrar{text-align:center}h1,h4{margin:auto}div p.version{text-align:right;padding:0 1rem;font-size:.8rem;color:#565656;cursor:pointer}h1{font-weight:bolder}ol{padding-left:2rem}input[type="file"]{display:none}label{display:inline-block}.custom-button.disable{background-color:#d3d3d3;color:#000;cursor:not-allowed}label.custom-button.disable:hover{background-color:#d3d3d3;color:#ff4500}.custom-button{border-radius:4px;background-color:var(--first-color);color:var(--second-color);cursor:pointer;font-size:1rem;margin:.3rem auto;padding:.3rem .6rem;text-align:center;border:none}.custom-button:hover{background-color:var(--second-color);color:var(--first-color)}ul li{list-style-type:none;margin-bottom:.3rem}.custom-radio{display:inline-flex;align-items:center;cursor:pointer}label.custom-radio>input[type="radio"]{display:none}.custom-radio-show{position:relative;background-color:var(--first-color);border-radius:50%;width:1rem;height:1rem}.custom-radio-show::after{position:absolute;content:"";background-color:var(--background);top:12.5%;left:12.5%;width:75%;height:75%;border-radius:50%}.custom-radio>input[type="radio"]:checked~.custom-radio{background-color:var(--first-color);color:var(--second-color)}.custom-radio>input[type="radio"]:checked+.custom-radio-show::after{position:absolute;content:"";background-color:var(--second-color);top:12.5%;left:12.5%;width:75%;height:75%;border-radius:50%}span.custom-radio-text{margin-left:.3rem;padding:0 .2rem}div.loading-frame{position:absolute;top:0;left:0;width:100%;height:100%;backdrop-filter:blur(5px)}div.loading-frame div.loading{position:relative;background-color:var(--first-color);color:var(--second-color);text-align:center;max-width:40%;margin:auto;top:50%;padding:2rem;border-radius:5px;transform:translate(-0%,-50%);-webkit-transform:translate(-0%,-50%)}div.loading p{margin:auto;font-weight:bold;font-size:larger}table{border-collapse:collapse;border:2px solid var(--first-color)}th,td{border-bottom:1px solid #808080}tr td{max-height:1rem}tr td input[type='text']{width:100%;text-align:center}tr:nth-last-of-type(2n+0){background-color:#d3d3d3}tbody tr:hover{background-color:var(--second-color);cursor:grab}tbody tr.editable{background-color:var(--edicion-color);color:#fff;font-style:italic;cursor:text}tbody tr:hover td input[type='text']{color:var(--second-color);background-color:var(--first-color);cursor:text}tbody tr td input[type='text'].is-fictitious-location{background-color:var(--warning-color)}.cabecera{background-color:var(--first-color);color:var(--second-color)}.padding-small{padding:0 .2em}@media print{body,html{background-color:transparent !important;color:#000 !important}.hide-print{display:none !important}.cabecera{background-color:#6d5454;color:#000}.borde{border:2px solid #000}td p.text-print-overflow-hidden{overflow:hidden;max-height:1rem;display:block}tbody tr td input[type='text'].is-fictitious-location{print-color-adjust:exact;-webkit-print-color-adjust:exact;background-color:#8f8f8f;color:#fff}p.version{print-color-adjust:exact;-webkit-print-color-adjust:exact;color:#808080}}.unstyle{all:unset}</style><title></title></head><body><div class="loading-frame no-visible" id=loading-frame><div class=loading><p id=loading>Cargando...</p></div></div><div class="container margen-alta-05 margen-bajo"><h1 id=title class="margen-bajo centrar">Previsión Excesos en el Full <span class=version-titulo id=version-titulo></span></h1><p class=hide-print><strong>Objetivo: </strong>Verificación de stock para la prevención de excesos en el fulfillment.</p></div><div class="container hide-print margen-bajo"><ol><li><label for="">Seleccionar archivo de datos:</label><div class=ancho-100> <label class=custom-button id=upload-file-b for=file-input>Subir archivo...</label><input type=file id=file-input /></div></li><li><label class=margen-bajo for="">Seleccione el dia de la semana:</label><div><ul><li> <label for=estateOne class=custom-radio><input type=radio name=estate id=estateOne value=estateOne checked /> <span class="custom-radio custom-radio-show"></span> <span class="custom-radio custom-radio-text">Lunes / Jueves</span></label></li><li><label for=estateTwo class=custom-radio><input type=radio name=estate id=estateTwo value=estateTwo /><span class="custom-radio custom-radio-show"></span> <span class="custom-radio custom-radio-text">Martes / Viernes</span></label></li><li><label for=estateThree class=custom-radio><input type=radio name=estate id=estateThree value=estateThree /><span class="custom-radio custom-radio-show"></span> <span class="custom-radio custom-radio-text">Miercóles / Sábado</span></label></li></ul></div></li><li><label for="">Analizar el archivo seleccionado:</label><div><input id=process-file class="custom-button disable" type=button value="Procesar Archivo" disabled /></div></li><li><label for="">Editar ubicaciones de venta e imprimir el documento:</label><div><input class="custom-button disable" id=print-button type=button value="Imprimir resultados" disabled /></div></li></ol></div><div class=container><table id=data-table class="borde margen-bajo"><thead><tr class="cabecera centrar borde"><th class=padding-small>No.</th><th class=padding-small>HFB</th><th>Descripción</th><th>Stock</th><th>Art. No.</th><th>Lugar de Venta</th></tr></thead><tbody id=data-body></tbody></table><div><h4 class="margen-bajo centrar">Final de la Tabla</h4></div></div><div class=margen-bajo-05><p id=version-footer class="version ancho-50"></p></div><script src=https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js></script><script>
    "use strict";class o{constructor(e){if(!e){console.log("ERROR:ExcelFileOpen: No se ha seleccionado ningun archivo.");throw new Error("No se ha seleccionado ningun archivo.")}this.file=e}}function r(e){if(e===undefined||e.length<=0){return false}if(e[0][E]===undefined||e[0][R]===undefined||e[e.length-1][v]===undefined||e[e.length-1][p]===undefined||e[e.length-1][O]===undefined||e[e.length-1][b]===undefined){return false}return true}function F(e){return e.filter(e=>{return e[ORDER_TYPE_EXCEL].trim()===ORDER_TYPE_DATA})}function l(e,t){let n=t;if(e===undefined||!e.name.toLowerCase().endsWith(f)&&e.type!==d){console.log('ERROR:readReportsExcel: El archivo "'+e.name+'" NO es válido.');throw new Error('El archivo "'+e.name+'" NO es válido.')}if(!r(n)){console.log("ERROR:readReportsExcel: Contenido del archivo NO válido.");throw new Error("Contenido del archivo NO válido.")}return n}function P(e){let o=new Map;e.forEach(t=>{if(!o.has(t[ISELL])){let e=new OrderDetail(t[ISELL]);o.set(t[ISELL],e)}let e=new Product(t);let n=o.get(t[ISELL]);n.t(e,t[PICK_AREA]);o.set(n.o,n)});return o}"use strict";class c{constructor(e,t,n,o,r,c,i){this.i=Number(e);this.l(t);this.u=n.trim();this.h=Number(o);this.R=Number(r);this.m=Number(c);this.v=i.trim();this.p=0}l(e){let t=String(e);this.O=t.padStart(8,"0")}}const a=document.getElementById("loading-frame");const H=document.getElementById("loading");const e=document.getElementById("file-input");const t=document.getElementsByName("estate");const i=document.getElementById("data-body");const u=document.getElementById("process-file");const n=document.getElementById("print-button");const s="2.0";const d="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";const f=".xlsm";const h="Data";const E="HFB";const R="ARTNO";const m="ARTNAME_UNICODE";const v="AVGSALES";const p="SLID_H";const O="SALESMETHOD";const b="AVAILABLESTOCK";const w="estateOne";const A="estateTwo";const S="estateThree";const _="is-fictitious-location";const L=/950150/;const K=/950250/;const X=/[a-z]/i;let T=[];let N=[];e.addEventListener("change",V);u.addEventListener("click",Y);n.addEventListener("click",$);i.addEventListener("click",te);i.addEventListener("focusout",ne);window.onload=function(){try{g()}catch(e){console.log("ERROR ONLOAD: ",e);alert(e.message)}};function B(){let e=new Date;switch(e.getDay()){case 1:case 4:document.getElementById(w).checked=true;break;case 2:case 5:document.getElementById(A).checked=true;break;case 3:case 6:document.getElementById(S).checked=true;break;default:console.log("es Domingo?")}}function g(){N=T=[];document.title="Previsión Excesos en el Full(v"+s+")";document.getElementById("version-titulo").innerText="(v"+s+")";document.getElementById("version-footer").innerText="Versión "+s+" - (https://github.com/perseo1326/IK-Control-Revison-Inventarios.git)";console.log("Versión: ",s);a.classList.add("no-visible");document.getElementById("upload-file-b").innerText="Subir archivo...";B()}function V(n){try{let e=n.target.files[0];a.classList.remove("no-visible");let t=new o(e);U(t)}catch(e){console.log("ERROR:openFile: ",e);alert(e.message);g()}}function U(r){let e=new FileReader;const c="utils";const i="sheet_to_row_object_array";const s="Sheets";e.readAsArrayBuffer(r.file);e.onload=function(){try{let e=this.result;let t=XLSX["read"](e);let n=XLSX[c][i](t[s][h]);let o=l(r.file,n);console.log('Carga "'+r.file.name+'" Finalizada!',o);document.getElementById("upload-file-b").innerText=r.file.name;o=z(o);T=q(o);a.classList.add("no-visible");u.classList.remove("disable");u.disabled=false}catch(e){console.log("ERROR:",e);alert(e.message);window.onload();return}}}function q(e){let n=[];e.forEach(e=>{let t=new c(e[E],e[R],e[m],e[O],e[v],e[b],e[p]);n.push(t)});return n}function z(e){return e.filter(e=>{return e[O]===2})}function Y(){try{let e=j();if(e===undefined){console.log("ERROR:processData: Error en la seleccion del dia de la semana(estado).");throw new Error("Error en la seleccion del dia de la semana(estado).")}N=G(e,T);x(N);n.classList.remove("disable");n.disabled=false}catch(e){console.log(e);alert(e.message)}}function j(){for(let e=0;e<t.length;e++){if(t[e].checked){return t[e].value}}return undefined}function G(e,t){let n=[];switch(e){case w:n=J(t);console.log("removeHFB_Kitchens",n.length);n=y(n);console.log("filterAvgSales_MoreThanCero",n.length);n=C(n);console.log("filterAvailableStock_MoreThanCero",n.length);k(n);n=D(n);console.log("filterRotationRatio_MoreThanOne",n.length);n=I(n);break;case A:n=Q(t);console.log("selectOnlyHFB_Kitchens",n.length);n=y(n);console.log("filterAvgSales_MoreThanCero",n.length);n=C(n);console.log("filterAvailableStock_MoreThanCero",n.length);k(n);n=D(n);console.log("filterRotationRatio_MoreThanOne",n.length);n=I(n);break;case S:n=W(t);console.log("filterAvgSales_LessThanEqualOne",n.length);n=Z(n);console.log("filterAvailableStock_OnlyEqualOne",n.length);n=I(n);break;default:console.log("ERROR:processContent: Error inesperado, actualice la pagina.");throw new Error("Error inesperado, actualice la pagina.")}return n}function J(e){return e.filter(e=>{return e.i!==7})}function y(e){return e.filter(e=>{return e.R>0})}function C(e){return e.filter(e=>{return e.m>0})}function k(e){for(const t of e){if(t.R!==0){t.p=t.m/t.R}}}function D(e){return e.filter(e=>{return e.p<1})}function Q(e){return e.filter(e=>{return e.i===7})}function W(e){return e.filter(e=>{return e.R<=1})}function Z(e){return e.filter(e=>{return e.m===1})}function I(e){return e.sort((e,t)=>e.v.localeCompare(t.v))}function $(){console.log("printing document...");N=I(N);x(N);window.print()}function x(e){i.innerHTML="";let t="";let n=1;e.forEach(e=>{t+=ee(e,n);n++});i.innerHTML+=t}function ee(e,t){let n="";let o="";n+="<tr class=''>";n+="<td class='centrar'>";n+=t;n+="</td>";n+="<td class='centrar'>";n+=e.i;n+="</td>";n+="<td><p class='text-print-overflow-hidden'>";n+=e.u;n+="</p></td>";n+="<td class='centrar'>";n+=e.m;n+="</td>";n+="<td>";n+="<input type='text' class='unstyle' value='";n+=e.O;n+="' readonly />";n+="</td>";if(M(e.v)){o=_}n+="<td class='centrar' >";n+="<input type='text' name='' class='unstyle "+o+"' id='"+(t-1)+"' ";n+="value='"+e.v+"' ";n+=" />";n+="</td>";n+="</tr>";return n}function M(e){if(!e||L.test(e)||K.test(e)||X.test(e)){return true}return false}function te(e){const t=e.srcElement;if(t.tagName==="INPUT"&&t.classList.contains("unstyle")&&t.classList.contains(_)){t.parentElement.parentElement.classList.add("editable")}}function ne(e){const t=e.srcElement;if(t.tagName==="INPUT"&&t.classList.contains("unstyle")&&t.classList.contains(_)){t.parentElement.parentElement.classList.remove("editable");oe(t.id,t.value);if(!M(t.value)){t.classList.remove(_);t.readOnly=true}}}function oe(e,t){if(N[e].v!==t){N[e].v=t}}
</script></body></html>